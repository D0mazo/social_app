<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Social App</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <h1>Social App</h1>
        <div class="nav-buttons">
            <a href="/signup" class="nav-button">Sign Up</a>
            <a href="/login" class="nav-button">Login</a>
        </div>
    </nav>
    <div class="container">
        <h2>All Posts</h2>
        <p class="prompt-message">Sign up or log in to create your own posts!</p>
        <div id="all-posts"></div>
    </div>
    <script>
        async function fetchAllPosts() {
            try {
                const response = await fetch('/api/all-posts');
                console.log('Fetch all posts response status:', response.status);
                const posts = await response.json();
                console.log('Fetch all posts data:', posts);
                const postsDiv = document.getElementById('all-posts');
                postsDiv.innerHTML = '';
                if (posts.length === 0) {
                    postsDiv.innerHTML = '<p>No posts yet. Be the first to share!</p>';
                } else {
                    posts.forEach(post => {
                        const postElement = document.createElement('div');
                        postElement.className = 'post';
                        postElement.innerHTML = post.type === 'photo' 
                            ? `<img src="${post.content}" alt="User post" class="post-image">
                               <small>Posted by User ${post.userId} on ${new Date(post.createdAt).toLocaleString()}</small>`
                            : `<p>${post.content}</p>
                               <small>Posted by User ${post.userId} on ${new Date(post.createdAt).toLocaleString()}</small>`;
                        postsDiv.appendChild(postElement);
                    });
                }
            } catch (error) {
                console.error('Fetch all posts error:', error);
                const postsDiv = document.getElementById('all-posts');
                postsDiv.innerHTML = '<p class="error">Error: Unable to fetch posts</p>';
            }
        }

        // Fetch posts when the page loads
        fetchAllPosts();
    </script>
</body>
</html>